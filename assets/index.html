<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.25.1/full/pyodide.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      window.addEventListener('load', function () {
        async function main(code) {
          try {
            const pyodide = await loadPyodide()
            const result = pyodide.runPython(code)
            sendMessageToFlutter('Success: ' + result)
          } catch (error) {
            sendMessageToFlutter('Error: ' + error)
          }
        }
        function sendMessageToFlutter(message) {
          window.parent.postMessage(message, '*')
        }
        window.addEventListener('message', (message) => {
          main(message.data)
        })
      })
    </script>
  </body>
</html>
